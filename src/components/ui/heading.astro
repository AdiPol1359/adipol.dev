---
import { cva } from 'cva';

import type { HTMLTag, Polymorphic } from 'astro/types';
import type { VariantProps } from 'cva';

const heading = cva({
	base: 'text-heading',
	variants: {
		size: {
			h1: 'text-5xl font-bold laptop:text-6xl',
			h2: 'text-xl font-semibold laptop:text-2xl',
			h3: 'text-lg font-medium laptop:text-xl',
			h4: 'text-lg font-medium',
		},
		withShadow: {
			false: null,
			true: 'relative z-0 before:absolute before:top-0.75 before:left-0.25 before:-z-1 before:text-[1.3em] before:text-nowrap before:opacity-5 before:content-(--shadow)',
		},
	},
});

type Props<T extends HTMLTag> = Readonly<{
	shadow?: string;
}> &
	Polymorphic<{ as: T }> &
	Required<Omit<VariantProps<typeof heading>, 'withShadow'>>;

const { as, shadow, size } = Astro.props as Props<'h1'>;

const Tag = as ?? size;
---

<Tag
	class={heading({ size, withShadow: Boolean(shadow) })}
	style={{ ...(shadow && { '--shadow': `'${shadow}'/''` }) }}
>
	<slot />
</Tag>
